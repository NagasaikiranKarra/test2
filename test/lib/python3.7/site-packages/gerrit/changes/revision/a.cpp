#include <bits/stdc++.h>
#define ll long long int
using namespace std;
vector<ll>bucket(1000001);
int main(){
    ios_base::sync_with_stdio(false);
    cin.tie(NULL);
    ll n,q,m,t;
    cin>>t;
    while(t--){
        cin>>n>>q>>m;
        vector<ll>v(n);
        for(ll i=0;i<n;i++) cin>>v[i];bucket.clear();
        vector<ll> ans(m+1);
        map<pair<ll,ll>,ll>hash;
        while(q--){
            ll l,r;
            cin>>l>>r;
            l--;
            r--;
            if(v[l]>m) continue;
            else if(v[l]<=m&&v[r]>m) bucket[v[l]]++,bucket[m+1]--;
            else if(v[r]<=m){
                bucket[v[l]]++;
                bucket[m+1]--;
                hash[{v[l],v[r]}]++;
            }
        }
        for(auto it:hash){
            ll ff=it.first.first;
            ll p=it.first.second;
            ll l=it.second;
            
            bucket[p+ff]-=l;
            bucket[p+2*ff]+=l;
            ll c=p+2*ff;
            while(c+p<=m){
                c+=p;
                bucket[c]-=l;
                bucket[c+ff]+=l;
                c+=ff;
            }
        }
        ll ct=INT_MIN;
        for(ll i=1;i<=m;i++) {
            bucket[i]+=bucket[i-1];
            ct=max(ct,bucket[i]);
        }
        cout<<ct<<"\n";
    }
}